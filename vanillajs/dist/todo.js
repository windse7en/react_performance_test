!function(t){function e(i){if(o[i])return o[i].exports;var n=o[i]={exports:{},id:i,loaded:!1};return t[i].call(n.exports,n,n.exports,e),n.loaded=!0,n.exports}var o={};return e.m=t,e.c=o,e.p="",e(0)}([function(t,e,o){t.exports=o(1)},function(t,e,o){"use strict";o(3),o(5),o(4),o(6),o(7),o(2),function(){function t(t){this.storage=new app.Store(t),this.model=new app.Model(this.storage),this.template=new app.Template,this.view=new app.View(this.template),this.controller=new app.Controller(this.model,this.view)}function e(){o.controller.setView(document.location.hash)}var o=new t("todos-vanillajs");$on(window,"load",e),$on(window,"hashchange",e)}()},function(t,e){"use strict";!function(t){function e(t,e){var o=this;o.model=t,o.view=e,o.view.bind("newTodo",function(t){o.addItem(t)}),o.view.bind("itemEdit",function(t){o.editItem(t.id)}),o.view.bind("itemEditDone",function(t){o.editItemSave(t.id,t.title)}),o.view.bind("itemEditCancel",function(t){o.editItemCancel(t.id)}),o.view.bind("itemRemove",function(t){o.removeItem(t.id)}),o.view.bind("itemToggle",function(t){o.toggleComplete(t.id,t.completed)}),o.view.bind("removeCompleted",function(){o.removeCompletedItems()}),o.view.bind("toggleAll",function(t){o.toggleAll(t.completed)})}e.prototype.setView=function(t){var e=t.split("/")[1],o=e||"";this._updateFilterState(o)},e.prototype.showAll=function(){var t=this;t.model.read(function(e){t.view.render("showEntries",e)})},e.prototype.showActive=function(){var t=this;t.model.read({completed:!1},function(e){t.view.render("showEntries",e)})},e.prototype.showCompleted=function(){var t=this;t.model.read({completed:!0},function(e){t.view.render("showEntries",e)})},e.prototype.addItem=function(t){var e=this;""!==t.trim()&&e.model.create(t,function(){e.view.render("clearNewTodo"),e._filter(!0)})},e.prototype.editItem=function(t){var e=this;e.model.read(t,function(o){e.view.render("editItem",{id:t,title:o[0].title})})},e.prototype.editItemSave=function(t,e){var o=this;e=e.trim(),0!==e.length?o.model.update(t,{title:e},function(){o.view.render("editItemDone",{id:t,title:e})}):o.removeItem(t)},e.prototype.editItemCancel=function(t){var e=this;e.model.read(t,function(o){e.view.render("editItemDone",{id:t,title:o[0].title})})},e.prototype.removeItem=function(t){var e=this;e.model.remove(t,function(){e.view.render("removeItem",t)}),e._filter()},e.prototype.removeCompletedItems=function(){var t=this;t.model.read({completed:!0},function(e){e.forEach(function(e){t.removeItem(e.id)})}),t._filter()},e.prototype.toggleComplete=function(t,e,o){var i=this;i.model.update(t,{completed:e},function(){i.view.render("elementComplete",{id:t,completed:e})}),o||i._filter()},e.prototype.toggleAll=function(t){var e=this;e.model.read({completed:!t},function(o){o.forEach(function(o){e.toggleComplete(o.id,t,!0)})}),e._filter()},e.prototype._updateCount=function(){var t=this;t.model.getCount(function(e){t.view.render("updateElementCount",e.active),t.view.render("clearCompletedButton",{completed:e.completed,visible:e.completed>0}),t.view.render("toggleAll",{checked:e.completed===e.total}),t.view.render("contentBlockVisibility",{visible:e.total>0})})},e.prototype._filter=function(t){var e=this._activeRoute.charAt(0).toUpperCase()+this._activeRoute.substr(1);this._updateCount(),(t||"All"!==this._lastActiveRoute||this._lastActiveRoute!==e)&&this["show"+e](),this._lastActiveRoute=e},e.prototype._updateFilterState=function(t){this._activeRoute=t,""===t&&(this._activeRoute="All"),this._filter(),this.view.render("setFilter",t)},t.app=t.app||{},t.app.Controller=e}(window)},function(t,e){"use strict";!function(t){t.qs=function(t,e){return(e||document).querySelector(t)},t.qsa=function(t,e){return(e||document).querySelectorAll(t)},t.$on=function(t,e,o,i){t.addEventListener(e,o,!!i)},t.$delegate=function(e,o,i,n){function r(i){var r=i.target,l=t.qsa(o,e),a=Array.prototype.indexOf.call(l,r)>=0;a&&n.call(r,i)}var l="blur"===i||"focus"===i;t.$on(e,i,r,l)},t.$parent=function(e,o){if(e.parentNode)return e.parentNode.tagName.toLowerCase()===o.toLowerCase()?e.parentNode:t.$parent(e.parentNode,o)},NodeList.prototype.forEach=Array.prototype.forEach}(window)},function(t,e){"use strict";var o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol?"symbol":typeof t};!function(t){function e(t){this.storage=t}e.prototype.create=function(t,e){t=t||"",e=e||function(){};var o={title:t.trim(),completed:!1};this.storage.save(o,e)},e.prototype.read=function(t,e){var i="undefined"==typeof t?"undefined":o(t);return e=e||function(){},"function"===i?(e=t,this.storage.findAll(e)):void("string"===i||"number"===i?(t=parseInt(t,10),this.storage.find({id:t},e)):this.storage.find(t,e))},e.prototype.update=function(t,e,o){this.storage.save(e,o,t)},e.prototype.remove=function(t,e){this.storage.remove(t,e)},e.prototype.removeAll=function(t){this.storage.drop(t)},e.prototype.getCount=function(t){var e={active:0,completed:0,total:0};this.storage.findAll(function(o){o.forEach(function(t){t.completed?e.completed++:e.active++,e.total++}),t(e)})},t.app=t.app||{},t.app.Model=e}(window)},function(t,e){"use strict";!function(t){function e(t,e){if(e=e||function(){},this._dbName=t,!localStorage[t]){var o={todos:[]};localStorage[t]=JSON.stringify(o)}e.call(this,JSON.parse(localStorage[t]))}e.prototype.find=function(t,e){if(e){var o=JSON.parse(localStorage[this._dbName]).todos;e.call(this,o.filter(function(e){for(var o in t)if(t[o]!==e[o])return!1;return!0}))}},e.prototype.findAll=function(t){t=t||function(){},t.call(this,JSON.parse(localStorage[this._dbName]).todos)},e.prototype.save=function(t,e,o){var i=JSON.parse(localStorage[this._dbName]),n=i.todos;if(e=e||function(){},o){for(var r=0;r<n.length;r++)if(n[r].id===o){for(var l in t)n[r][l]=t[l];break}localStorage[this._dbName]=JSON.stringify(i),e.call(this,JSON.parse(localStorage[this._dbName]).todos)}else t.id=(new Date).getTime(),n.push(t),localStorage[this._dbName]=JSON.stringify(i),e.call(this,[t])},e.prototype.remove=function(t,e){for(var o=JSON.parse(localStorage[this._dbName]),i=o.todos,n=0;n<i.length;n++)if(i[n].id==t){i.splice(n,1);break}localStorage[this._dbName]=JSON.stringify(o),e.call(this,JSON.parse(localStorage[this._dbName]).todos)},e.prototype.drop=function(t){localStorage[this._dbName]=JSON.stringify({todos:[]}),t.call(this,JSON.parse(localStorage[this._dbName]).todos)},t.app=t.app||{},t.app.Store=e}(window)},function(t,e){"use strict";!function(t){function e(){this.defaultTemplate='<li data-id="{{id}}" class="{{completed}}"><div class="view"><input class="toggle" type="checkbox" {{checked}}><label>{{title}}</label><button class="destroy"></button></div></li>'}var o={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=function(t){return o[t]},n=/[&<>"'`]/g,r=new RegExp(n.source),l=function(t){return t&&r.test(t)?t.replace(n,i):t};e.prototype.show=function(t){var e,o,i="";for(e=0,o=t.length;e<o;e++){var n=this.defaultTemplate,r="",a="";t[e].completed&&(r="completed",a="checked"),n=n.replace("{{id}}",t[e].id),n=n.replace("{{title}}",l(t[e].title)),n=n.replace("{{completed}}",r),n=n.replace("{{checked}}",a),i+=n}return i},e.prototype.itemCounter=function(t){var e=1===t?"":"s";return"<strong>"+t+"</strong> item"+e+" left"},e.prototype.clearCompletedButton=function(t){return t>0?"Clear completed":""},t.app=t.app||{},t.app.Template=e}(window)},function(t,e){"use strict";!function(t){function e(t){this.template=t,this.ENTER_KEY=13,this.ESCAPE_KEY=27,this.$todoList=qs(".todo-list"),this.$todoItemCounter=qs(".todo-count"),this.$clearCompleted=qs(".clear-completed"),this.$main=qs(".main"),this.$footer=qs(".footer"),this.$toggleAll=qs(".toggle-all"),this.$newTodo=qs(".new-todo")}e.prototype._removeItem=function(t){var e=qs('[data-id="'+t+'"]');e&&this.$todoList.removeChild(e)},e.prototype._clearCompletedButton=function(t,e){this.$clearCompleted.innerHTML=this.template.clearCompletedButton(t),this.$clearCompleted.style.display=e?"block":"none"},e.prototype._setFilter=function(t){qs(".filters .selected").className="",qs('.filters [href="#/'+t+'"]').className="selected"},e.prototype._elementComplete=function(t,e){var o=qs('[data-id="'+t+'"]');o&&(o.className=e?"completed":"",qs("input",o).checked=e)},e.prototype._editItem=function(t,e){var o=qs('[data-id="'+t+'"]');if(o){o.className=o.className+" editing";var i=document.createElement("input");i.className="edit",o.appendChild(i),i.focus(),i.value=e}},e.prototype._editItemDone=function(t,e){var o=qs('[data-id="'+t+'"]');if(o){var i=qs("input.edit",o);o.removeChild(i),o.className=o.className.replace("editing",""),qsa("label",o).forEach(function(t){t.textContent=e})}},e.prototype.render=function(t,e){var o=this,i={showEntries:function(){o.$todoList.innerHTML=o.template.show(e)},removeItem:function(){o._removeItem(e)},updateElementCount:function(){o.$todoItemCounter.innerHTML=o.template.itemCounter(e)},clearCompletedButton:function(){o._clearCompletedButton(e.completed,e.visible)},contentBlockVisibility:function(){o.$main.style.display=o.$footer.style.display=e.visible?"block":"none"},toggleAll:function(){o.$toggleAll.checked=e.checked},setFilter:function(){o._setFilter(e)},clearNewTodo:function(){o.$newTodo.value=""},elementComplete:function(){o._elementComplete(e.id,e.completed)},editItem:function(){o._editItem(e.id,e.title)},editItemDone:function(){o._editItemDone(e.id,e.title)}};i[t]()},e.prototype._itemId=function(t){var e=$parent(t,"li");return parseInt(e.dataset.id,10)},e.prototype._bindItemEditDone=function(t){var e=this;$delegate(e.$todoList,"li .edit","blur",function(){this.dataset.iscanceled||t({id:e._itemId(this),title:this.value})}),$delegate(e.$todoList,"li .edit","keypress",function(t){t.keyCode===e.ENTER_KEY&&this.blur()})},e.prototype._bindItemEditCancel=function(t){var e=this;$delegate(e.$todoList,"li .edit","keyup",function(o){o.keyCode===e.ESCAPE_KEY&&(this.dataset.iscanceled=!0,this.blur(),t({id:e._itemId(this)}))})},e.prototype.bind=function(t,e){var o=this;"newTodo"===t?$on(o.$newTodo,"change",function(){e(o.$newTodo.value)}):"removeCompleted"===t?$on(o.$clearCompleted,"click",function(){e()}):"toggleAll"===t?$on(o.$toggleAll,"click",function(){e({completed:this.checked})}):"itemEdit"===t?$delegate(o.$todoList,"li label","dblclick",function(){e({id:o._itemId(this)})}):"itemRemove"===t?$delegate(o.$todoList,".destroy","click",function(){e({id:o._itemId(this)})}):"itemToggle"===t?$delegate(o.$todoList,".toggle","click",function(){e({id:o._itemId(this),completed:this.checked})}):"itemEditDone"===t?o._bindItemEditDone(e):"itemEditCancel"===t&&o._bindItemEditCancel(e)},t.app=t.app||{},t.app.View=e}(window)}]);
//# sourceMappingURL=todo.js.map